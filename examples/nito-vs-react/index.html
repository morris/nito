<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Nito vs. React</title>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="css/app.css">
  </head>
  <body>

    <div class="container" id="main">

      <h1><a href="https://github.com/morris/nito">Nito</a> vs. React</h1>

      <p>Benchmark concept originally by
        <a href="https://github.com/jonmiles/react-performance-tests">Jonathan Miles</a>.
        Start Chrome with <code>--enable-precise-memory-info</code> for accurate memory stats.</p>

      <hr>

      <div class="form-inline">
        <div class="form-group">
          <label for="comps">Number of components</label>
          <input type="text" class="form-control" id="comps" value="100">
        </div>
        <div class="form-group">
          <label for="rate">Rate of change</label>
          <input type="text" class="form-control" id="rate" value="0.3">
        </div>
        <button class="btn btn-primary" id="benchmark">Benchmark</button>
      </div>

      <hr>

      <div class="row">

        <div class="col-sm-4" id="nito"></div>
        <div class="col-sm-4" id="react"></div>
        <div class="col-sm-4">

          <pre id="log"></pre>

        </div>

      </div>

      <hr>

    </div>

    <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
    <script src="../../nito.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/15.4.1/react.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/15.4.1/react-dom.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.2/lodash.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/platform/1.3.3/platform.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/benchmark/2.1.2/benchmark.min.js"></script>
    <script src="https://cdn.rawgit.com/paulirish/memory-stats.js/6fa0f35/memory-stats.js"></script>

    <script src="js/Store.js"></script>
    <script src="js/NitoDashboard.js"></script>
    <script src="js/ReactDashboard.js"></script>

    <script>
      var store = new Store();
      store.change( parseInt( $( '#comps' ).val(), 10 ), 0 );

      var nitoDashboard = NitoDashboard.create( null, store ).appendTo( '#nito' );
      var reactDashboard = ReactDOM.render(
        React.createElement( ReactDashboard, { store: store } ),
        document.getElementById( 'react' )
      );

      $( '#benchmark' ).on( 'click', function () {

        var suite = new Benchmark.Suite();
        var comps = parseInt( $( '#comps' ).val(), 10 );
        var rate = parseFloat( $( '#rate' ).val(), 10 );

        suite.add( 'Nito', function () {

          store.change( comps, rate );
          nitoDashboard.update();

        } ).add( 'React', function() {

          store.change( comps, rate );
          reactDashboard.update();

        } ).on( 'cycle', function ( event ) {

          $( '#log' ).append( String( event.target ) + '\n' );

        } ).on( 'complete', function () {

          $( '#log' ).append( 'Fastest is ' + this.filter( 'fastest' )[ 0 ][ 'name' ] + '\n' );

        } ).run( { 'async': true } );

      } );

      var stats = new MemoryStats();

      stats.domElement.style.position = 'fixed';
      stats.domElement.style.right = '0px';
      stats.domElement.style.top = '0px';

      document.body.appendChild( stats.domElement );

      function updateStats() {
        stats.update();
        requestAnimationFrame( updateStats );
      }

      updateStats();

    </script>

  </body>
</html>
